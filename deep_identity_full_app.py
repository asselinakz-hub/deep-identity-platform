import streamlit as st
import pandas as pd
from collections import defaultdict

# ----------------------------------------
# –û–ë–©–ò–ï –ö–û–ù–°–¢–ê–ù–¢–´
# ----------------------------------------

POTENTIALS = [
    "–ê–º–µ—Ç–∏—Å—Ç",
    "–ì—Ä–∞–Ω–∞—Ç",
    "–¶–∏—Ç—Ä–∏–Ω",
    "–°–∞–ø—Ñ–∏—Ä",
    "–ì–µ–ª–∏–æ–¥–æ—Ä",
    "–ò–∑—É–º—Ä—É–¥",
    "–Ø–Ω—Ç–∞—Ä—å",
    "–†—É–±–∏–Ω",
    "–®—É–Ω–≥–∏—Ç",
]

# c1 = –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ/–∏–Ω—Ç—É–∏—Ü–∏—è/–ø—Ä–∏—á–∏–Ω–∞
# c2 = –ø—Ä–æ—Ü–µ—Å—Å/—Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ/—Å–∞–º–æ–≤—ã—Ä–∞–∂–µ–Ω–∏–µ
# c3 = –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç/–¥–µ–π—Å—Ç–≤–∏–µ/—Ä–µ–∑—É–ª—å—Ç–∞—Ç
COLUMNS = ["c1", "c2", "c3"]


# ----------------------------------------
# –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø SESSION_STATE
# ----------------------------------------

def init_session_state():
    if "initialized" not in st.session_state:
        st.session_state.initialized = True

    # –¢–∞–±–ª–∏—Ü—ã –ø–æ –±–ª–æ–∫–∞–º
    for block in (1, 2, 3):
        cols_key = f"block{block}_cols"
        text_key = f"block{block}_text"
        if cols_key not in st.session_state:
            st.session_state[cols_key] = {
                p: {c: 0 for c in COLUMNS} for p in POTENTIALS
            }
        if text_key not in st.session_state:
            st.session_state[text_key] = ""


# ----------------------------------------
# –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–û–ï: –î–û–ë–ê–í–õ–ï–ù–ò–ï –í–ï–°–û–í
# ----------------------------------------

def add_score(local_scores, pot, col, value):
    """–£–¥–æ–±–Ω—ã–π —Ö–µ–ª–ø–µ—Ä: —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –±–∞–ª–ª—ã –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ pot –≤ —Å—Ç–æ–ª–±—Ü–µ col."""
    if pot not in local_scores:
        local_scores[pot] = {c: 0 for c in COLUMNS}
    local_scores[pot][col] += value


# ========================================
# –ë–õ–û–ö 1 ‚Äî –î–ï–¢–°–¢–í–û, –ï–°–¢–ï–°–¢–í–ï–ù–ù–´–ï –°–ö–õ–û–ù–ù–û–°–¢–ò
# ========================================

def run_block1():
    st.header("–ë–ª–æ–∫ 1. –î–µ—Ç—Å—Ç–≤–æ, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç–∏, –±–∞–∑–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã")

    st.markdown(
        "–í—Å–ø–æ–º–∏–Ω–∞–µ–º **–¥–µ—Ç—Å—Ç–≤–æ –∏ —à–∫–æ–ª—å–Ω—ã–µ –≥–æ–¥—ã**. "
        "–°–º–æ—Ç—Ä–∏ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –Ω–µ –∫–∞–∫ –Ω–∞ —ç–∫–∑–∞–º–µ–Ω, –∞ –∫–∞–∫ –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–æ–≥–æ, "
        "–∫–∞–∫ —Ç—ã –ø—Ä–æ—è–≤–ª—è–ª—Å—è(–∞—Å—å) —Å–∞–º(–∞) –ø–æ —Å–µ–±–µ ‚Äî –¥–æ –≤—Å–µ—Ö ¬´–Ω–∞–¥–æ¬ª –∏ ¬´–ø—Ä–∞–≤–∏–ª—å–Ω–æ¬ª."
    )

    # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –±–∞–ª–ª–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ –±–ª–æ–∫–∞
    local_scores = {p: {c: 0 for c in COLUMNS} for p in POTENTIALS}
    text_fragments = []

    st.subheader("1. –°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –≤ –¥–µ—Ç—Å—Ç–≤–µ")

    q1 = st.radio(
        "–ö–∞–∫ —Ç—ã —á–∞—â–µ –≤—Å–µ–≥–æ –ø—Ä–æ–≤–æ–¥–∏–ª(–∞) —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –ª–µ—Ç –¥–æ 10?",
        options=[
            "–ê–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã –Ω–∞ —É–ª–∏—Ü–µ: –±–µ–≥, –¥–æ–≥–æ–Ω—è–ª–∫–∏, –ª–∞–∑–∞–Ω–∏–µ, —Å–ø–æ—Ä—Ç",
            "–ö–Ω–∏–≥–∏, –∫—Ä–æ—Å—Å–≤–æ—Ä–¥—ã, –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ ‚Äî –ª—é–±–∏–ª(–∞) –¥—É–º–∞—Ç—å",
            "–ò–≥—Ä—ã –≤ ¬´–º–∞–≥–∞–∑–∏–Ω¬ª, –ø—Ä–æ–¥–∞–∂–∏, –æ–±–º–µ–Ω—ã, –º–∏–Ω–∏-–±–∏–∑–Ω–µ—Å—ã",
            "–°—Ç–∞–≤–∏–ª(–∞) –∫–æ–Ω—Ü–µ—Ä—Ç—ã, —Å—Ü–µ–Ω–∫–∏, –ª—é–±–∏–ª(–∞) –≤—ã—Å—Ç—É–ø–∞—Ç—å",
            "–í–æ–∑–∏–ª—Å—è(–∞—Å—å) —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏, –∂–∞–ª–µ–ª(–∞), –ª–µ—á–∏–ª(–∞), –∫–æ—Ä–º–∏–ª(–∞)",
            "–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã, –õ–µ–≥–æ, –º–æ–∑–∞–∏–∫–∏, —Å—Ö–µ–º—ã, —Ä–∞–∑–±–æ—Ä/—Å–±–æ—Ä –≤–µ—â–µ–π",
            "–ë–æ–ª—å—à–µ –±–æ–ª—Ç–∞–ª(–∞), —à—É—Ç–∏–ª(–∞), –ª—é–±–∏–ª(–∞) –∫–æ–º–ø–∞–Ω–∏–∏",
        ],
        key="b1_q1",
    )

    if q1 == "–ê–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã –Ω–∞ —É–ª–∏—Ü–µ: –±–µ–≥, –¥–æ–≥–æ–Ω—è–ª–∫–∏, –ª–∞–∑–∞–Ω–∏–µ, —Å–ø–æ—Ä—Ç":
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
    elif q1 == "–ö–Ω–∏–≥–∏, –∫—Ä–æ—Å—Å–≤–æ—Ä–¥—ã, –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏ ‚Äî –ª—é–±–∏–ª(–∞) –¥—É–º–∞—Ç—å":
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 1)
    elif q1 == "–ò–≥—Ä—ã –≤ ¬´–º–∞–≥–∞–∑–∏–Ω¬ª, –ø—Ä–æ–¥–∞–∂–∏, –æ–±–º–µ–Ω—ã, –º–∏–Ω–∏-–±–∏–∑–Ω–µ—Å—ã":
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
    elif q1 == "–°—Ç–∞–≤–∏–ª(–∞) –∫–æ–Ω—Ü–µ—Ä—Ç—ã, —Å—Ü–µ–Ω–∫–∏, –ª—é–±–∏–ª(–∞) –≤—ã—Å—Ç—É–ø–∞—Ç—å":
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
    elif q1 == "–í–æ–∑–∏–ª—Å—è(–∞—Å—å) —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏, –∂–∞–ª–µ–ª(–∞), –ª–µ—á–∏–ª(–∞), –∫–æ—Ä–º–∏–ª(–∞)":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
    elif q1 == "–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã, –õ–µ–≥–æ, –º–æ–∑–∞–∏–∫–∏, —Å—Ö–µ–º—ã, —Ä–∞–∑–±–æ—Ä/—Å–±–æ—Ä –≤–µ—â–µ–π":
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 1)
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
    elif q1 == "–ë–æ–ª—å—à–µ –±–æ–ª—Ç–∞–ª(–∞), —à—É—Ç–∏–ª(–∞), –ª—é–±–∏–ª(–∞) –∫–æ–º–ø–∞–Ω–∏–∏":
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 2)

    st.subheader("2. –®–∫–æ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã")

    q2 = st.multiselect(
        "–ö–∞–∫–∏–µ —à–∫–æ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã —Ç—ã –ª—é–±–∏–ª(–∞) –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
        options=[
            "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ / —Ñ–∏–∑–∏–∫–∞ / –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞",
            "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ / –∏—Å—Ç–æ—Ä–∏—è / –æ–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ",
            "–ú—É–∑—ã–∫–∞ / –ø–µ–Ω–∏–µ / —Ç–µ–∞—Ç—Ä",
            "–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞ / —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è",
            "–†–∏—Å–æ–≤–∞–Ω–∏–µ / –¥–∏–∑–∞–π–Ω / —Ç—Ä—É–¥",
            "–ù–∏—á–µ–≥–æ –æ—Å–æ–±–æ –Ω–µ –ª—é–±–∏–ª(–∞), —É—á–∏–ª—Å—è(–∞—Å—å) ¬´–∫–∞–∫ –Ω–∞–¥–æ¬ª",
        ],
        key="b1_q2",
    )

    if "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ / —Ñ–∏–∑–∏–∫–∞ / –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞" in q2:
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 1)
    if "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ / –∏—Å—Ç–æ—Ä–∏—è / –æ–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ" in q2:
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
    if "–ú—É–∑—ã–∫–∞ / –ø–µ–Ω–∏–µ / —Ç–µ–∞—Ç—Ä" in q2:
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
    if "–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞ / —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è" in q2:
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
    if "–†–∏—Å–æ–≤–∞–Ω–∏–µ / –¥–∏–∑–∞–π–Ω / —Ç—Ä—É–¥" in q2:
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
    if "–ù–∏—á–µ–≥–æ –æ—Å–æ–±–æ –Ω–µ –ª—é–±–∏–ª(–∞), —É—á–∏–ª—Å—è(–∞—Å—å) ¬´–∫–∞–∫ –Ω–∞–¥–æ¬ª" in q2:
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 1)

    st.subheader("3. –ö—Ä—É–∂–∫–∏ –∏ —Å–µ–∫—Ü–∏–∏")

    q3 = st.multiselect(
        "–ù–∞ –∫–∞–∫–∏–µ –∫—Ä—É–∂–∫–∏/—Å–µ–∫—Ü–∏–∏ —Ç—ã —Ö–æ–¥–∏–ª(–∞) –¥–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∏ –ø–æ –ª—é–±–≤–∏?",
        options=[
            "–°–ø–æ—Ä—Ç (–±–æ–∏, —Ñ—É—Ç–±–æ–ª, —Ç–∞–Ω—Ü—ã, –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∞ –∏ —Ç.–ø.)",
            "–ú—É–∑—ã–∫–∞/–≤–æ–∫–∞–ª/—Ç–µ–∞—Ç—Ä/—Ç–∞–Ω—Ü—ã –∫–∞–∫ —Å—Ü–µ–Ω–∞",
            "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫—Ä—É–∂–∫–∏, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞",
            "–†–∏—Å–æ–≤–∞–Ω–∏–µ, –¥–∏–∑–∞–π–Ω, hand-made, –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–µ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ",
            "–ë–∏–∑–Ω–µ—Å/–ª–∏–¥–µ—Ä—Å—Ç–≤–æ/–¥–µ–±–∞—Ç—ã/–æ–ª–∏–º–ø–∏–∞–¥—ã –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ",
            "–ü–æ—á—Ç–∏ –Ω–∏–∫—É–¥–∞ –Ω–µ —Ö–æ–¥–∏–ª(–∞) / –≤—Å—ë –±—ã–ª–æ ¬´–ø–æ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏¬ª",
        ],
        key="b1_q3",
    )

    if "–°–ø–æ—Ä—Ç (–±–æ–∏, —Ñ—É—Ç–±–æ–ª, —Ç–∞–Ω—Ü—ã, –≥–∏–º–Ω–∞—Å—Ç–∏–∫–∞ –∏ —Ç.–ø.)" in q3:
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
    if "–ú—É–∑—ã–∫–∞/–≤–æ–∫–∞–ª/—Ç–µ–∞—Ç—Ä/—Ç–∞–Ω—Ü—ã –∫–∞–∫ —Å—Ü–µ–Ω–∞" in q3:
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
    if "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫—Ä—É–∂–∫–∏, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞" in q3:
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 2)
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
    if "–†–∏—Å–æ–≤–∞–Ω–∏–µ, –¥–∏–∑–∞–π–Ω, hand-made, –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–µ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ" in q3:
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
    if "–ë–∏–∑–Ω–µ—Å/–ª–∏–¥–µ—Ä—Å—Ç–≤–æ/–¥–µ–±–∞—Ç—ã/–æ–ª–∏–º–ø–∏–∞–¥—ã –ø–æ —ç–∫–æ–Ω–æ–º–∏–∫–µ" in q3:
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 1)
    if "–ü–æ—á—Ç–∏ –Ω–∏–∫—É–¥–∞ –Ω–µ —Ö–æ–¥–∏–ª(–∞) / –≤—Å—ë –±—ã–ª–æ ¬´–ø–æ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏¬ª" in q3:
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 1)

    st.subheader("4. –†–æ–ª—å –Ω–∞ —à–∫–æ–ª—å–Ω—ã—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–∞—Ö")

    q4 = st.radio(
        "–ü—Ä–µ–¥—Å—Ç–∞–≤—å —à–∫–æ–ª—å–Ω—ã–π –ø—Ä–∞–∑–¥–Ω–∏–∫. –ì–¥–µ —Ç—ã —Å–µ–±—è —á–∞—â–µ –≤–∏–¥–µ–ª(–∞)?",
        options=[
            "–ù–∞ —Å—Ü–µ–Ω–µ ‚Äî –≤—ã—Å—Ç—É–ø–∞—Ç—å, —á–∏—Ç–∞—Ç—å, —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å",
            "–ó–∞ –∫—É–ª–∏—Å–∞–º–∏ ‚Äî –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å, –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π",
            "–í –∑–∞–ª–µ ‚Äî –Ω–∞–±–ª—é–¥–∞—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, —Ä–∞–¥–æ–≤–∞—Ç—å—Å—è –∑–∞ –¥—Ä—É–≥–∏—Ö",
        ],
        key="b1_q4",
    )

    if q4 == "–ù–∞ —Å—Ü–µ–Ω–µ ‚Äî –≤—ã—Å—Ç—É–ø–∞—Ç—å, —á–∏—Ç–∞—Ç—å, —Ç–∞–Ω—Ü–µ–≤–∞—Ç—å":
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
    elif q4 == "–ó–∞ –∫—É–ª–∏—Å–∞–º–∏ ‚Äî –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å, –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π":
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 1)
    elif q4 == "–í –∑–∞–ª–µ ‚Äî –Ω–∞–±–ª—é–¥–∞—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, —Ä–∞–¥–æ–≤–∞—Ç—å—Å—è –∑–∞ –¥—Ä—É–≥–∏—Ö":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 1)
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 1)

    st.subheader("5. –ñ–∏–≤–æ—Ç–Ω—ã–µ")

    q5 = st.radio(
        "–ë—ã–ª–∏ –ª–∏ —É —Ç–µ–±—è –¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ –∏ –∫–∞–∫ —Ç—ã –∫ –Ω–∏–º –æ—Ç–Ω–æ—Å–∏–ª—Å—è(–∞—Å—å)?",
        options=[
            "–î–∞, —Å–∏–ª—å–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞–ª—Å—è(–∞—Å—å), —É—Ö–∞–∂–∏–≤–∞–ª(–∞), –ø–µ—Ä–µ–∂–∏–≤–∞–ª(–∞) –∑–∞ –Ω–∏—Ö",
            "–î–∞, –Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ, –±–µ–∑ —Å–∏–ª—å–Ω–æ–π –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏",
            "–ü–æ—á—Ç–∏ –Ω–µ –±—ã–ª–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö / –º–∞–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–∏",
        ],
        key="b1_q5",
    )

    if q5 == "–î–∞, —Å–∏–ª—å–Ω–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞–ª—Å—è(–∞—Å—å), —É—Ö–∞–∂–∏–≤–∞–ª(–∞), –ø–µ—Ä–µ–∂–∏–≤–∞–ª(–∞) –∑–∞ –Ω–∏—Ö":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
    elif q5 == "–î–∞, –Ω–æ —Å–ø–æ–∫–æ–π–Ω–æ, –±–µ–∑ —Å–∏–ª—å–Ω–æ–π –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 1)

    st.subheader("6. –°–ø–æ—Ä—Ç –∏ —Ç–µ–ª–æ")

    q6 = st.radio(
        "–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏–ª—Å—è(–∞—Å—å) –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –Ω–∞–≥—Ä—É–∑–∫–∞–º –∏ —Å–ø–æ—Ä—Ç—É –≤ –¥–µ—Ç—Å—Ç–≤–µ?",
        options=[
            "–û–±–æ–∂–∞–ª(–∞) –¥–≤–∏–≥–∞—Ç—å—Å—è, —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–ª–æ, —É—Å—Ç–∞–ª–æ—Å—Ç—å, –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å —Å–µ–±—è",
            "–°–ø–æ—Ä—Ç –±—ã–ª, –Ω–æ –±–æ–ª—å—à–µ –∫–∞–∫ ¬´–Ω–∞–¥–æ¬ª, –±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º–∞",
            "–°–∫–æ—Ä–µ–µ –∏–∑–±–µ–≥–∞–ª(–∞) —Ñ–∏–∑–Ω–∞–≥—Ä—É–∑–æ–∫, –ª—é–±–∏–ª(–∞) —Å–ø–æ–∫–æ–π–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è",
        ],
        key="b1_q6",
    )

    if q6 == "–û–±–æ–∂–∞–ª(–∞) –¥–≤–∏–≥–∞—Ç—å—Å—è, —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–ª–æ, —É—Å—Ç–∞–ª–æ—Å—Ç—å, –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å —Å–µ–±—è":
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
    elif q6 == "–°–ø–æ—Ä—Ç –±—ã–ª, –Ω–æ –±–æ–ª—å—à–µ –∫–∞–∫ ¬´–Ω–∞–¥–æ¬ª, –±–µ–∑ —Ñ–∞–Ω–∞—Ç–∏–∑–º–∞":
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 1)
    elif q6 == "–°–∫–æ—Ä–µ–µ –∏–∑–±–µ–≥–∞–ª(–∞) —Ñ–∏–∑–Ω–∞–≥—Ä—É–∑–æ–∫, –ª—é–±–∏–ª(–∞) —Å–ø–æ–∫–æ–π–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è":
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)

    st.subheader("7. –ü–æ—Ä—è–¥–æ–∫")

    q7 = st.radio(
        "–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏–ª—Å—è(–∞—Å—å) –∫ –ø–æ—Ä—è–¥–∫—É –≤ –¥–µ—Ç—Å—Ç–≤–µ?",
        options=[
            "–õ—é–±–∏–ª(–∞) —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –≤—Å—ë –ø–æ –º–µ—Å—Ç–∞–º, —Ö–∞–æ—Å —Ä–∞–∑–¥—Ä–∞–∂–∞–ª",
            "–ü–æ—Ä—è–¥–æ–∫ –±—ã–ª –Ω–æ—Ä–º, –Ω–æ –Ω–µ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–ª—Å—è(–∞—Å—å)",
            "–ú–æ–≥(–ª–∞) –∂–∏—Ç—å –≤ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–º –±–µ—Å–ø–æ—Ä—è–¥–∫–µ, –≥–ª–∞–≤–Ω–æ–µ ‚Äî —á—Ç–æ–±—ã –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ",
        ],
        key="b1_q7",
    )

    if q7 == "–õ—é–±–∏–ª(–∞) —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞—Ç—å –≤—Å—ë –ø–æ –º–µ—Å—Ç–∞–º, —Ö–∞–æ—Å —Ä–∞–∑–¥—Ä–∞–∂–∞–ª":
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 2)
    elif q7 == "–ü–æ—Ä—è–¥–æ–∫ –±—ã–ª –Ω–æ—Ä–º, –Ω–æ –Ω–µ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–ª—Å—è(–∞—Å—å)":
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 1)
    elif q7 == "–ú–æ–≥(–ª–∞) –∂–∏—Ç—å –≤ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–º –±–µ—Å–ø–æ—Ä—è–¥–∫–µ, –≥–ª–∞–≤–Ω–æ–µ ‚Äî —á—Ç–æ–±—ã –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ":
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 1)
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 1)

    st.subheader("8. –ú–µ—á—Ç—ã –≤ –¥–µ—Ç—Å—Ç–≤–µ/–ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤–æ–º –≤–æ–∑—Ä–∞—Å—Ç–µ")

    q8 = st.multiselect(
        "–û —á—ë–º —Ç—ã –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –º–µ—á—Ç–∞–ª(–∞)?",
        options=[
            "–°—Ç–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–º(–æ–π), –ø–æ–ø—É–ª—è—Ä–Ω—ã–º(–æ–π), –±—ã—Ç—å –Ω–∞ –≤–∏–¥—É",
            "–û —Å–≤–æ—ë–º –±–∏–∑–Ω–µ—Å–µ, –±—ã—Ç—å —Ö–æ–∑—è–∏–Ω–æ–º —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏",
            "–ü–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º, –ª–µ—á–∏—Ç—å, —É—á–∏—Ç—å, –¥–µ–ª–∞—Ç—å –º–∏—Ä –ª—É—á—à–µ",
            "–û –∫—Ä–∞—Å–∏–≤–æ–π –∂–∏–∑–Ω–∏, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è—Ö, –∫—Ä–∞—Å–æ—Ç–µ –≤–æ–∫—Ä—É–≥",
            "–û —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –¥–æ–º–µ, —Å–µ–º–µ–π–Ω–æ–º —É—é—Ç–µ",
        ],
        key="b1_q8",
    )

    if "–°—Ç–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–º(–æ–π), –ø–æ–ø—É–ª—è—Ä–Ω—ã–º(–æ–π), –±—ã—Ç—å –Ω–∞ –≤–∏–¥—É" in q8:
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
    if "–û —Å–≤–æ—ë–º –±–∏–∑–Ω–µ—Å–µ, –±—ã—Ç—å —Ö–æ–∑—è–∏–Ω–æ–º —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏" in q8:
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 1)
    if "–ü–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º, –ª–µ—á–∏—Ç—å, —É—á–∏—Ç—å, –¥–µ–ª–∞—Ç—å –º–∏—Ä –ª—É—á—à–µ" in q8:
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 1)
    if "–û –∫—Ä–∞—Å–∏–≤–æ–π –∂–∏–∑–Ω–∏, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è—Ö, –∫—Ä–∞—Å–æ—Ç–µ –≤–æ–∫—Ä—É–≥" in q8:
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
    if "–û —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –¥–æ–º–µ, —Å–µ–º–µ–π–Ω–æ–º —É—é—Ç–µ" in q8:
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 2)

    st.subheader("9. –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —ç–º–ø–∞—Ç–∏—è")

    q9 = st.radio(
        "–ù–∞—Å–∫–æ–ª—å–∫–æ —Ç—ã –±—ã–ª(–∞) —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ä–µ–±—ë–Ω–∫–æ–º?",
        options=[
            "–û—á–µ–Ω—å: –º–æ–≥(–ª–∞) –∑–∞–ø–ª–∞–∫–∞—Ç—å –æ—Ç —Ñ–∏–ª—å–º–∞, —Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–∂–∏–≤–∞–ª(–∞) –∑–∞ –¥—Ä—É–≥–∏—Ö",
            "–°—Ä–µ–¥–Ω–µ: –∏–Ω–æ–≥–¥–∞ —Ç—Ä–æ–≥–∞–ª–æ, –Ω–æ –Ω–µ —á–∞—Å—Ç–æ",
            "–°–∫–æ—Ä–µ–µ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π(–∞—è), –º–∞–ª–æ —á—Ç–æ –∑–∞–¥–µ–≤–∞–ª–æ",
        ],
        key="b1_q9",
    )

    if q9 == "–û—á–µ–Ω—å: –º–æ–≥(–ª–∞) –∑–∞–ø–ª–∞–∫–∞—Ç—å –æ—Ç —Ñ–∏–ª—å–º–∞, —Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–∂–∏–≤–∞–ª(–∞) –∑–∞ –¥—Ä—É–≥–∏—Ö":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 1)
    elif q9 == "–°—Ä–µ–¥–Ω–µ: –∏–Ω–æ–≥–¥–∞ —Ç—Ä–æ–≥–∞–ª–æ, –Ω–æ –Ω–µ —á–∞—Å—Ç–æ":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 1)
    elif q9 == "–°–∫–æ—Ä–µ–µ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π(–∞—è), –º–∞–ª–æ —á—Ç–æ –∑–∞–¥–µ–≤–∞–ª–æ":
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)

    st.subheader("10. –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è")

    q10 = st.radio(
        "–ö–∞–∫ —Ç—ã –æ—Ç–Ω–æ—Å–∏–ª—Å—è(–∞—Å—å) –∫ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è–º?",
        options=[
            "–û—á–µ–Ω—å –≤–∞–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –ª—É—á—à–∏–º(–µ–π), —Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–∂–∏–≤–∞–ª(–∞), –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ª—É—á—à–µ",
            "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –±—ã—Ç—å –ø–µ—Ä–≤—ã–º(–æ–π)",
            "–ù–µ –ª—é–±–∏–ª(–∞) –¥—É—Ö —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π, –∏–∑–±–µ–≥–∞–ª(–∞) –∏—Ö",
        ],
        key="b1_q10",
    )

    if q10 == "–û—á–µ–Ω—å –≤–∞–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –ª—É—á—à–∏–º(–µ–π), —Å–∏–ª—å–Ω–æ –ø–µ—Ä–µ–∂–∏–≤–∞–ª(–∞), –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ª—É—á—à–µ":
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c3", 1)
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 1)
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 1)
    elif q10 == "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –±—ã—Ç—å –ø–µ—Ä–≤—ã–º(–æ–π)":
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 1)
    elif q10 == "–ù–µ –ª—é–±–∏–ª(–∞) –¥—É—Ö —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π, –∏–∑–±–µ–≥–∞–ª(–∞) –∏—Ö":
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 1)

    st.subheader("11. –¢–≤–æ—è —Ä–æ–ª—å —Å—Ä–µ–¥–∏ –¥–µ—Ç–µ–π")

    q11 = st.radio(
        "–ö–∞–∫—É—é —Ä–æ–ª—å —Ç—ã —á–∞—â–µ –∑–∞–Ω–∏–º–∞–ª(–∞) —Å—Ä–µ–¥–∏ –¥–µ—Ç–µ–π –≤–æ –¥–≤–æ—Ä–µ/–∫–ª–∞—Å—Å–µ?",
        options=[
            "–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä, –ø—Ä–∏–¥—É–º—ã–≤–∞–ª(–∞), –∫—É–¥–∞ –ø–æ–π—Ç–∏ –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å",
            "–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä: —Å–æ–±–∏—Ä–∞–ª(–∞), —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–ª(–∞), —Å–ª–µ–¥–∏–ª(–∞), —á—Ç–æ–±—ã –≤—Å—ë –ø—Ä–æ—à–ª–æ —Ö–æ—Ä–æ—à–æ",
            "–î—É—à–∞ –∫–æ–º–ø–∞–Ω–∏–∏: —à—É—Ç–∫–∏, –±–æ–ª—Ç–æ–≤–Ω—è, –æ–±—ä–µ–¥–∏–Ω—è–ª(–∞) –≤—Å–µ—Ö",
            "–¢–∏—Ö–∏–π –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å, –Ω–æ —Å 1‚Äì2 –±–ª–∏–∑–∫–∏–º–∏ –¥—Ä—É–∑—å—è–º–∏",
        ],
        key="b1_q11",
    )

    if q11 == "–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä, –ø—Ä–∏–¥—É–º—ã–≤–∞–ª(–∞), –∫—É–¥–∞ –ø–æ–π—Ç–∏ –∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å":
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 1)
    elif q11 == "–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä: —Å–æ–±–∏—Ä–∞–ª(–∞), —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–ª(–∞), —Å–ª–µ–¥–∏–ª(–∞), —á—Ç–æ–±—ã –≤—Å—ë –ø—Ä–æ—à–ª–æ —Ö–æ—Ä–æ—à–æ":
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 1)
    elif q11 == "–î—É—à–∞ –∫–æ–º–ø–∞–Ω–∏–∏: —à—É—Ç–∫–∏, –±–æ–ª—Ç–æ–≤–Ω—è, –æ–±—ä–µ–¥–∏–Ω—è–ª(–∞) –≤—Å–µ—Ö":
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 2)
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 1)
    elif q11 == "–¢–∏—Ö–∏–π –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å, –Ω–æ —Å 1‚Äì2 –±–ª–∏–∑–∫–∏–º–∏ –¥—Ä—É–∑—å—è–º–∏":
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 1)

    st.subheader("12. –°–≤–æ–±–æ–¥–Ω—ã–π —Ä–∞—Å—Å–∫–∞–∑")

    t1 = st.text_area(
        "–û–ø–∏—à–∏ 2‚Äì3 —è—Ä–∫–∏—Ö —ç–ø–∏–∑–æ–¥–∞ –∏–∑ –¥–µ—Ç—Å—Ç–≤–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã —á—É–≤—Å—Ç–≤–æ–≤–∞–ª(–∞) —Å–µ–±—è ¬´–Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ¬ª.",
        key="b1_text1",
        height=150,
    )
    if t1.strip():
        text_fragments.append("–≠–ø–∏–∑–æ–¥—ã –∏–∑ –¥–µ—Ç—Å—Ç–≤–∞:\n" + t1.strip())

    if st.button("‚úîÔ∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ë–ª–æ–∫–∞ 1"):
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ session_state
        st.session_state.block1_cols = local_scores

        full_text = "\n\n".join(text_fragments).strip()
        st.session_state.block1_text = full_text

        st.success("–ë–ª–æ–∫ 1 —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –ë–ª–æ–∫—É 2 üëå")

        st.write("–ß–µ—Ä–Ω–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –ë–ª–æ–∫—É 1:")
        st.json(local_scores)


# ========================================
# –ë–õ–û–ö 2 ‚Äî –†–ê–ë–û–¢–ê, –ü–†–û–¶–ï–°–°–´, –ö–ï–ô–°–´ (–ì–ò–ë–†–ò–î)
# ========================================

def run_block2():
    st.header("–ë–ª–æ–∫ 2. –†–∞–±–æ—Ç–∞, –ø—Ä–æ—Ü–µ—Å—Å—ã, –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏, —Å–º–µ—â–µ–Ω–∏—è")

    st.markdown(
        "–ó–¥–µ—Å—å –º—ã —Å–º–æ—Ç—Ä–∏–º –Ω–∞ **—Ç–µ–∫—É—â—É—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ª—é–±–∏–º—ã–µ –∏ –Ω–µ–ª—é–±–∏–º—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã**, "
        "–∞ —Ç–∞–∫–∂–µ –Ω–∞ —Ç–æ, –∫–∞–∫ —Ç—ã –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ—à–µ–Ω–∏—è –∏ —á—Ç–æ –¥–∞—ë—Ç —Ç–µ–±–µ –∞–∑–∞—Ä—Ç."
    )

    local_scores = {p: {c: 0 for c in COLUMNS} for p in POTENTIALS}
    text_fragments = []

    # 2.1 –ü—Ä–æ—Ñ–µ—Å—Å–∏—è –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã

    st.subheader("1. –ß–µ–º —Ç—ã –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è —Å–µ–π—á–∞—Å (form–∞–ª—å–Ω–æ)?")

    q1 = st.text_area(
        "–û–ø–∏—à–∏ —Å–≤–æ—é —Ç–µ–∫—É—â—É—é —Ä–∞–±–æ—Ç—É/–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ–ª–µ–π), –∫–æ—Ä–æ—Ç–∫–æ:",
        key="b2_q1",
        height=120,
    )
    if q1.strip():
        text_fragments.append("–¢–µ–∫—É—â–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å:\n" + q1.strip())

    st.subheader("2. –õ—é–±–∏–º—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ —Ä–∞–±–æ—Ç–µ")

    q2 = st.multiselect(
        "–ß—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ —Ç–µ–±–µ **–ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –Ω—Ä–∞–≤–∏—Ç—Å—è** –¥–µ–ª–∞—Ç—å –≤ —Ä–∞–±–æ—Ç–µ?",
        options=[
            "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö, –∏—Å–∫–∞—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏",
            "–ü—Ä–æ–¥—É–º—ã–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Å–∏—Å—Ç–µ–º—É",
            "–û–±—â–∞—Ç—å—Å—è —Å –ª—é–¥—å–º–∏, –≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã, –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å—Å—è",
            "–í—ã—Å—Ç—É–ø–∞—Ç—å, –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, –±—ã—Ç—å ¬´–ª–∏—Ü–æ–º¬ª",
            "–°–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–∞—Å–æ—Ç—É: –¥–∏–∑–∞–π–Ω, –≤–∏–∑—É–∞–ª, –∞—Ç–º–æ—Å—Ñ–µ—Ä—É, —É—é—Ç",
            "–°—á–∏—Ç–∞—Ç—å –¥–µ–Ω—å–≥–∏, –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å",
            "–û—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –ª—é–¥–µ–π",
            "–†–∞–±–æ—Ç–∞—Ç—å —Ç–µ–ª–æ–º: —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –º–∞—Å—Å–∞–∂, —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ç—Ä—É–¥, –ø—Ä–∞–∫—Ç–∏–∫–∞",
            "–£—á–∏—Ç—å, –æ–±—ä—è—Å–Ω—è—Ç—å, –¥–µ–ª–∏—Ç—å—Å—è –∑–Ω–∞–Ω–∏—è–º–∏, –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å",
        ],
        key="b2_q2",
    )

    for opt in q2:
        if opt == "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö, –∏—Å–∫–∞—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏":
            add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
        elif opt == "–ü—Ä–æ–¥—É–º—ã–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Å–∏—Å—Ç–µ–º—É":
            add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c2", 1)
            add_score(local_scores, "–†—É–±–∏–Ω", "c1", 1)
        elif opt == "–û–±—â–∞—Ç—å—Å—è —Å –ª—é–¥—å–º–∏, –≤–µ—Å—Ç–∏ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã, –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å—Å—è":
            add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 2)
        elif opt == "–í—ã—Å—Ç—É–ø–∞—Ç—å, –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, –±—ã—Ç—å ¬´–ª–∏—Ü–æ–º¬ª":
            add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
            add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
        elif opt == "–°–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–∞—Å–æ—Ç—É: –¥–∏–∑–∞–π–Ω, –≤–∏–∑—É–∞–ª, –∞—Ç–º–æ—Å—Ñ–µ—Ä—É, —É—é—Ç":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
        elif opt == "–°—á–∏—Ç–∞—Ç—å –¥–µ–Ω—å–≥–∏, –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å":
            add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
        elif opt == "–û—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã, –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –ª—é–¥–µ–π":
            add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
        elif opt == "–†–∞–±–æ—Ç–∞—Ç—å —Ç–µ–ª–æ–º: —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –º–∞—Å—Å–∞–∂, —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ç—Ä—É–¥, –ø—Ä–∞–∫—Ç–∏–∫–∞":
            add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
        elif opt == "–£—á–∏—Ç—å, –æ–±—ä—è—Å–Ω—è—Ç—å, –¥–µ–ª–∏—Ç—å—Å—è –∑–Ω–∞–Ω–∏—è–º–∏, –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å":
            add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)

    st.subheader("3. –ß—Ç–æ –¥–∞—ë—Ç—Å—è –ª–µ–≥—á–µ –≤—Å–µ–≥–æ")

    q3 = st.multiselect(
        "–ß—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ —É —Ç–µ–±—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è **–ª–µ–≥–∫–æ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ**, –¥–∞–∂–µ –µ—Å–ª–∏ —Ç—ã —ç—Ç–æ–º—É —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ —É—á–∏–ª—Å—è(–∞—Å—å)?",
        options=[
            "–°—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å—É—Ç—å –±—ã—Å—Ç—Ä–æ –∏ –æ–±—ä—è—Å–Ω—è—Ç—å –¥—Ä—É–≥–∏–º –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏",
            "–ß—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –ª—é–¥–µ–π, –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ø–æ–¥–±–∏—Ä–∞—Ç—å —Å–ª–æ–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
            "–ü—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∏–¥–µ–∏, –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, —Ñ–æ—Ä–º–∞—Ç—ã",
            "–í–∏–¥–µ—Ç—å, –≥–¥–µ –º–æ–∂–Ω–æ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å / —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å",
            "–ß—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–ª–æ, –¥–≤–∏–∂–µ–Ω–∏–µ, —Ç–µ—Ö–Ω–∏–∫—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π",
            "–ó–∞–º–µ—á–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, —Ü–≤–µ—Ç, —Å—Ç–∏–ª—å, –¥–∏—Å–≥–∞—Ä–º–æ–Ω–∏—é",
            "–°–≤—è–∑—ã–≤–∞—Ç—å —Å–º—ã—Å–ª—ã, –≤–∏–¥–µ—Ç—å –æ–±—â—É—é –∫–∞—Ä—Ç–∏–Ω—É",
        ],
        key="b2_q3",
    )

    for opt in q3:
        if opt == "–°—Ö–≤–∞—Ç—ã–≤–∞—Ç—å —Å—É—Ç—å –±—ã—Å—Ç—Ä–æ –∏ –æ–±—ä—è—Å–Ω—è—Ç—å –¥—Ä—É–≥–∏–º –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏":
            add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
            add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
        elif opt == "–ß—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å –ª—é–¥–µ–π, –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ø–æ–¥–±–∏—Ä–∞—Ç—å —Å–ª–æ–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
        elif opt == "–ü—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∏–¥–µ–∏, –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, —Ñ–æ—Ä–º–∞—Ç—ã":
            add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 1)
            add_score(local_scores, "–†—É–±–∏–Ω", "c1", 1)
        elif opt == "–í–∏–¥–µ—Ç—å, –≥–¥–µ –º–æ–∂–Ω–æ –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å / —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å":
            add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
        elif opt == "–ß—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–ª–æ, –¥–≤–∏–∂–µ–Ω–∏–µ, —Ç–µ—Ö–Ω–∏–∫—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π":
            add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
        elif opt == "–ó–∞–º–µ—á–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, —Ü–≤–µ—Ç, —Å—Ç–∏–ª—å, –¥–∏—Å–≥–∞—Ä–º–æ–Ω–∏—é":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
        elif opt == "–°–≤—è–∑—ã–≤–∞—Ç—å —Å–º—ã—Å–ª—ã, –≤–∏–¥–µ—Ç—å –æ–±—â—É—é –∫–∞—Ä—Ç–∏–Ω—É":
            add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
            add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 1)

    st.subheader("4. –ù–µ–ª—é–±–∏–º—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã")

    q4 = st.multiselect(
        "–ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —Ç–µ–±—è **–∑–∞–±–∏—Ä–∞—é—Ç —ç–Ω–µ—Ä–≥–∏—é**, –¥–∞–∂–µ –µ—Å–ª–∏ —Ç—ã —Ö–æ—Ä–æ—à–æ —ç—Ç–æ —É–º–µ–µ—à—å?",
        options=[
            "–†—É—Ç–∏–Ω–∞, –æ—Ç—á—ë—Ç—ã, —Ç–∞–±–ª–∏—Ü—ã, –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–µ—Ç–∞–ª–µ–π",
            "–•–æ–ª–æ–¥–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏, –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã, —Ç–æ—Ä–≥",
            "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –ø—É–±–ª–∏—á–Ω–æ—Å—Ç—å",
            "–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑, –¥–ª–∏–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã, —Å–ª–æ–∂–Ω—ã–µ —Å–º—ã—Å–ª—ã",
            "–§–∏–∑–∏—á–µ—Å–∫–∏–π —Ç—Ä—É–¥, –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ, —Å–ø–æ—Ä—Ç",
            "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è, –¥–µ–¥–ª–∞–π–Ω—ã",
            "–¢–≤–æ—Ä—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –±–µ–∑ –ø–æ–Ω—è—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Å—Ä–æ–∫–æ–≤",
        ],
        key="b2_q4",
    )

    # –ó–¥–µ—Å—å –ª–æ–≥–∏–∫–∞ ¬´–º–∏–Ω—É—Å¬ª ‚Äî –º–æ–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–∞–∫ —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞, –Ω–æ –ø–æ–∫–∞
    # –º—ã –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –±–∞–ª–ª—ã (–∏–ª–∏ –¥–æ–±–∞–≤–ª—è–µ–º –º–∞–ª–æ –≤ –¥—Ä—É–≥–∏–µ —Å—Ç–æ–ª–±—Ü—ã).
    # –ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –º–æ–∂–Ω–æ –ø–æ—Ç–æ–º –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ø–æ–¥ —Å–º–µ—â–µ–Ω–∏—è.

    st.subheader("5. –ö–∞–∫ —Ç—ã –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ—à–µ–Ω–∏—è")

    q5 = st.radio(
        "–ß—Ç–æ —É —Ç–µ–±—è **—Ä–µ–∞–ª—å–Ω–æ** —á–∞—â–µ –≤—Å–µ–≥–æ —Ä–µ—à–∞–µ—Ç, —Å–¥–µ–ª–∞—Ç—å/–Ω–µ —Å–¥–µ–ª–∞—Ç—å?",
        options=[
            "–õ–æ–≥–∏–∫–∞, –∞–Ω–∞–ª–∏–∑ ¬´–∑–∞¬ª –∏ ¬´–ø—Ä–æ—Ç–∏–≤¬ª",
            "–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ, –±—É–¥—Ç–æ ¬´–∑–Ω–∞—é, —á—Ç–æ —Ç–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ¬ª",
            "–≠–º–æ—Ü–∏—è/–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: –∫–∞–∫ —è —Å–µ–±—è —á—É–≤—Å—Ç–≤—É—é —Å —ç—Ç–∏–º",
            "–°–º—ã—Å–ª/–º–∏—Å—Å–∏—è: —ç—Ç–æ –≤–æ–æ–±—â–µ –ø—Ä–æ –º–µ–Ω—è –∏ –º–æ–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏?",
            "–í—ã–≥–æ–¥–∞: –¥–µ–Ω—å–≥–∏, —Ä–µ—Å—É—Ä—Å—ã, –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã",
            "–õ—é–¥–∏: –∫–æ–º—É —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç / –∫–∞–∫ —ç—Ç–æ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö",
            "–ê–∑–∞—Ä—Ç –∏ –∏–Ω—Ç–µ—Ä–µ—Å: –ø—Ä–æ—Å—Ç–æ —Ö–æ—á–µ—Ç—Å—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å",
        ],
        key="b2_q5",
    )

    if q5 == "–õ–æ–≥–∏–∫–∞, –∞–Ω–∞–ª–∏–∑ ¬´–∑–∞¬ª –∏ ¬´–ø—Ä–æ—Ç–∏–≤¬ª":
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 1)
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
    elif q5 == "–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ, –±—É–¥—Ç–æ ¬´–∑–Ω–∞—é, —á—Ç–æ —Ç–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ¬ª":
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
    elif q5 == "–≠–º–æ—Ü–∏—è/–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: –∫–∞–∫ —è —Å–µ–±—è —á—É–≤—Å—Ç–≤—É—é —Å —ç—Ç–∏–º":
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 1)
    elif q5 == "–°–º—ã—Å–ª/–º–∏—Å—Å–∏—è: —ç—Ç–æ –≤–æ–æ–±—â–µ –ø—Ä–æ –º–µ–Ω—è –∏ –º–æ–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏?":
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
    elif q5 == "–í—ã–≥–æ–¥–∞: –¥–µ–Ω—å–≥–∏, —Ä–µ—Å—É—Ä—Å—ã, –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã":
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
    elif q5 == "–õ—é–¥–∏: –∫–æ–º—É —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç / –∫–∞–∫ —ç—Ç–æ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
    elif q5 == "–ê–∑–∞—Ä—Ç –∏ –∏–Ω—Ç–µ—Ä–µ—Å: –ø—Ä–æ—Å—Ç–æ —Ö–æ—á–µ—Ç—Å—è –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å":
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 1)
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 1)

    # 2.2 –ö–ï–ô–°–´

    st.subheader("6. –ö–µ–π—Å—ã: —Ä–∞–±–æ—á–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏")

    q6 = st.radio(
        "–ü—Ä–µ–¥—Å—Ç–∞–≤—å: –µ—Å—Ç—å –≤–∞–∂–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑–Ω–∞—è, —Å—Ä–æ–∫–∏ –∂–º—É—Ç. "
        "–ß—Ç–æ —Ç—ã **–¥–µ–ª–∞–µ—à—å –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º**?",
        options=[
            "–†–∞–∑–±–∏—Ä–∞—é—Å—å, –∫–∞–∫–∞—è —Ü–µ–ª—å –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ (—Å–º—ã—Å–ª, KPI)",
            "–°–æ–±–∏—Ä–∞—é –ª—é–¥–µ–π, –æ–±—Å—É–∂–¥–∞–µ–º, –∫—Ç–æ —á—Ç–æ –¥–µ–ª–∞–µ—Ç",
            "–°—Ä–∞–∑—É –¥—É–º–∞—é, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ –º–æ–Ω–µ—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å / –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–µ–Ω—å–≥–∞–º",
            "–°–º–æ—Ç—Ä—é, –∫–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É –ª—é–¥–µ–π, –∫–æ–º—É —á—Ç–æ —Å–µ–π—á–∞—Å –Ω—É–∂–Ω–æ",
            "–ü—Ä–æ–≤–µ—Ä—è—é —Ñ–∞–∫—Ç—ã, –¥–∞–Ω–Ω—ã–µ, —Ä–µ—Å—É—Ä—Å—ã, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è",
            "–ù–∞—á–∏–Ω–∞—é –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å–∞–º(–∞): –ø–∏—Å–∞—Ç—å, –¥–µ–ª–∞—Ç—å, –∑–≤–æ–Ω–∏—Ç—å",
            "–ü—Ä–∏–¥—É–º—ã–≤–∞—é –∫–æ–Ω—Ü–µ–ø—Ü–∏—é/–∏–¥–µ—é, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –ø–æ-–æ—Å–æ–±–µ–Ω–Ω–æ–º—É",
        ],
        key="b2_q6",
    )

    if q6 == "–†–∞–∑–±–∏—Ä–∞—é—Å—å, –∫–∞–∫–∞—è —Ü–µ–ª—å –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ (—Å–º—ã—Å–ª, KPI)":
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 1)
    elif q6 == "–°–æ–±–∏—Ä–∞—é –ª—é–¥–µ–π, –æ–±—Å—É–∂–¥–∞–µ–º, –∫—Ç–æ —á—Ç–æ –¥–µ–ª–∞–µ—Ç":
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
    elif q6 == "–°—Ä–∞–∑—É –¥—É–º–∞—é, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–Ω–æ –º–æ–Ω–µ—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å / –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–µ–Ω—å–≥–∞–º":
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
    elif q6 == "–°–º–æ—Ç—Ä—é, –∫–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É –ª—é–¥–µ–π, –∫–æ–º—É —á—Ç–æ —Å–µ–π—á–∞—Å –Ω—É–∂–Ω–æ":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
    elif q6 == "–ü—Ä–æ–≤–µ—Ä—è—é —Ñ–∞–∫—Ç—ã, –¥–∞–Ω–Ω—ã–µ, —Ä–µ—Å—É—Ä—Å—ã, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è":
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 2)
    elif q6 == "–ù–∞—á–∏–Ω–∞—é –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å–∞–º(–∞): –ø–∏—Å–∞—Ç—å, –¥–µ–ª–∞—Ç—å, –∑–≤–æ–Ω–∏—Ç—å":
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
    elif q6 == "–ü—Ä–∏–¥—É–º—ã–≤–∞—é –∫–æ–Ω—Ü–µ–ø—Ü–∏—é/–∏–¥–µ—é, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –ø–æ-–æ—Å–æ–±–µ–Ω–Ω–æ–º—É":
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 1)
        add_score(local_scores, "–†—É–±–∏–Ω", "c1", 1)

    q7 = st.radio(
        "–ï—Å–ª–∏ –±—ã —Ç–µ–±–µ –¥–∞–ª–∏ –ø—Ä–∞–≤–æ **—Å–Ω—è—Ç—å —Å —Å–µ–±—è 30% —Ä–∞–±–æ—Ç—ã**, –æ—Ç —á–µ–≥–æ –±—ã —Ç—ã –æ—Ç–∫–∞–∑–∞–ª—Å—è(–∞—Å—å) –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?",
        options=[
            "–û—Ç —Ä—É—Ç–∏–Ω—ã, –æ—Ç—á—ë—Ç–æ–≤, —Ç–∞–±–ª–∏—á–µ–∫, —á–µ–∫-–ª–∏—Å—Ç–æ–≤",
            "–û—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤ –∏ –æ–±—â–µ–Ω–∏—è —Å –ª—é–¥—å–º–∏",
            "–û—Ç –ø—É–±–ª–∏—á–Ω—ã—Ö –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏–π –∏ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π",
            "–û—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–º—ã–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø–ª–∞–Ω—ã",
            "–û—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏/–≤—ã–µ–∑–¥–æ–≤/–ø–æ–ª–µ–≤–æ–π —Ä–∞–±–æ—Ç—ã",
            "–û—Ç —Ç–≤–æ—Ä—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á, –≥–¥–µ –Ω—É–∂–Ω–æ –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –Ω–æ–≤–æ–µ",
        ],
        key="b2_q7",
    )

    # –ó–¥–µ—Å—å —Ç–æ–∂–µ –º–æ–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–∞–∫ —Å–ª–∞–±—ã–µ —á–∞—Å—Ç–∏, –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –±–∞–ª–ª—ã.

    st.subheader("7. –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–∞–Ω—è—Ç")

    q8 = st.multiselect(
        "–ï—Å–ª–∏ –±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ **—Å–º–µ–ª–æ –ø–µ—Ä–µ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ä–æ–ª–∏**, —á—Ç–æ —Ç–µ–±—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç?",
        options=[
            "–ê–Ω–∞–ª–∏—Ç–∏–∫ / –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å / —Å—Ç—Ä–∞—Ç–µ–≥",
            "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å / –≤–ª–∞–¥–µ–ª–µ—Ü –±–∏–∑–Ω–µ—Å–∞",
            "–ù–∞—Å—Ç–∞–≤–Ω–∏–∫ / –∫–æ—É—á / –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å",
            "–î–∏–∑–∞–π–Ω–µ—Ä / —Å—Ç–∏–ª–∏—Å—Ç / —Ö—É–¥–æ–∂–Ω–∏–∫ / –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä",
            "–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π / –ø—Ä–æ–¥—é—Å–µ—Ä / –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤",
            "–í–µ–¥—É—â–∏–π / –±–ª–æ–≥–µ—Ä / –∞–∫—Ç—ë—Ä / —Å—Ç–µ–Ω–¥–∞–ø–µ—Ä",
            "–¢—Ä–µ–Ω–µ—Ä / –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ —Ç–µ–ª—É / –º–∞—Å—Å–∞–∂–∏—Å—Ç / —Ñ–∏–∑–∏–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç",
        ],
        key="b2_q8",
    )

    for opt in q8:
        if opt == "–ê–Ω–∞–ª–∏—Ç–∏–∫ / –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å / —Å—Ç—Ä–∞—Ç–µ–≥":
            add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
        elif opt == "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å / –≤–ª–∞–¥–µ–ª–µ—Ü –±–∏–∑–Ω–µ—Å–∞":
            add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
            add_score(local_scores, "–†—É–±–∏–Ω", "c2", 1)
        elif opt == "–ù–∞—Å—Ç–∞–≤–Ω–∏–∫ / –∫–æ—É—á / –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å":
            add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
        elif opt == "–î–∏–∑–∞–π–Ω–µ—Ä / —Å—Ç–∏–ª–∏—Å—Ç / —Ö—É–¥–æ–∂–Ω–∏–∫ / –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
        elif opt == "–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏–π / –ø—Ä–æ–¥—é—Å–µ—Ä / –º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤":
            add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
        elif opt == "–í–µ–¥—É—â–∏–π / –±–ª–æ–≥–µ—Ä / –∞–∫—Ç—ë—Ä / —Å—Ç–µ–Ω–¥–∞–ø–µ—Ä":
            add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 2)
            add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 1)
        elif opt == "–¢—Ä–µ–Ω–µ—Ä / –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ —Ç–µ–ª—É / –º–∞—Å—Å–∞–∂–∏—Å—Ç / —Ñ–∏–∑–∏–æ—Ç–µ—Ä–∞–ø–µ–≤—Ç":
            add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)

    st.subheader("8. –°–≤–æ–±–æ–¥–Ω—ã–π —Ä–∞—Å—Å–∫–∞–∑ –ø—Ä–æ —Ä–∞–±–æ—Ç—É")

    t2 = st.text_area(
        "–û–ø–∏—à–∏ –æ–¥–∏–Ω –¥–µ–Ω—å/–Ω–µ–¥–µ–ª—é, –∫–æ–≥–¥–∞ —Ç—ã –±—ã–ª(–∞) –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤ —Ä–µ—Å—É—Ä—Å–µ –Ω–∞ —Ä–∞–±–æ—Ç–µ. "
        "–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –¥–µ–ª–∞–ª(–∞), —Å –∫–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª(–∞), –∫–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã —à–ª–∏ –ª–µ–≥–∫–æ?",
        key="b2_text1",
        height=180,
    )
    if t2.strip():
        text_fragments.append("–†–∞–±–æ—á–∏–π —Ä–µ—Å—É—Ä—Å–Ω—ã–π –¥–µ–Ω—å:\n" + t2.strip())

    if st.button("‚úîÔ∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ë–ª–æ–∫–∞ 2"):
        st.session_state.block2_cols = local_scores
        full_text = "\n\n".join(text_fragments).strip()
        st.session_state.block2_text = full_text

        st.success("–ë–ª–æ–∫ 2 —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∫ –ë–ª–æ–∫—É 3 ‚ú®")
        st.write("–ß–µ—Ä–Ω–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –ë–ª–æ–∫—É 2:")
        st.json(local_scores)


# ========================================
# –ë–õ–û–ö 3 ‚Äî –û–ö–†–£–ñ–ï–ù–ò–ï, –ì–ï–†–û–ò, –í–°–ï–õ–ï–ù–ù–´–ï (–ì–ò–ë–†–ò–î)
# ========================================

def run_block3():
    st.header("–ë–ª–æ–∫ 3. –û–∫—Ä—É–∂–µ–Ω–∏–µ, –≥–µ—Ä–æ–∏, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –º–∏—Ä—ã")

    st.markdown(
        "–ó–¥–µ—Å—å –º—ã —Å–º–æ—Ç—Ä–∏–º –Ω–∞ **–ª—é–¥–µ–π, –≥–µ—Ä–æ–µ–≤ –∏ –º–∏—Ä—ã**, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–±—è —Ü–µ–ø–ª—è—é—Ç –∏–ª–∏ "
        "–æ—Ç—Ç–∞–ª–∫–∏–≤–∞—é—Ç. –ß–µ—Ä–µ–∑ —ç—Ç–æ —Ö–æ—Ä–æ—à–æ –≤–∏–¥–Ω–æ 2-–π —Ä—è–¥ –∏ —Å—Ç–æ–ª–±—Ü—ã."
    )

    local_scores = {p: {c: 0 for c in COLUMNS} for p in POTENTIALS}
    text_fragments = []

    st.subheader("1. –õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–º–∏ —Ç—ã –≤–æ—Å—Ö–∏—â–∞–µ—à—å—Å—è")

    q1 = st.multiselect(
        "–ö–∞–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞/—Ç–∏–ø—ã –ª—é–¥–µ–π –≤—ã–∑—ã–≤–∞—é—Ç —É —Ç–µ–±—è **–≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ**?",
        options=[
            "–ì–ª—É–±–∏–Ω–∞, –º—É–¥—Ä–æ—Å—Ç—å, —É–º–µ–Ω–∏–µ –≤–∏–¥–µ—Ç—å —Å—É—Ç—å –∏ –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏",
            "–Ø—Ä–∫–æ—Å—Ç—å, —Ö–∞—Ä–∏–∑–º–∞, —É–º–µ–Ω–∏–µ –∑–∞–∂–∏–≥–∞—Ç—å –∏ –≤–µ—Å—Ç–∏ –∑–∞ —Å–æ–±–æ–π —Ç–æ–ª–ø—É",
            "–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å—Ç—Ä–æ–∏—Ç—å –±–∏–∑–Ω–µ—Å, —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–µ–Ω—å–≥–∏ –∏ —Ü–µ–Ω–Ω–æ—Å—Ç—å",
            "–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ª–µ—á–∏—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
            "–≠—Å—Ç–µ—Ç–∏–∫–∞, –≤–∫—É—Å, —á—É–≤—Å—Ç–≤–æ —Å—Ç–∏–ª—è –∏ –∫—Ä–∞—Å–æ—Ç—ã",
            "–°–∏–ª–∞ —Ç–µ–ª–∞, –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å, —Å–º–µ–ª–æ—Å—Ç—å –≤ –¥–µ–π—Å—Ç–≤–∏–∏",
            "–£–º–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –∫–æ–º–∞–Ω–¥—ã",
            "–õ—ë–≥–∫–æ—Å—Ç—å –≤ –æ–±—â–µ–Ω–∏–∏, —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞, —É–º–µ–Ω–∏–µ —Ä–∞–∑—Ä—è–∂–∞—Ç—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ",
        ],
        key="b3_q1",
    )

    for opt in q1:
        if opt == "–ì–ª—É–±–∏–Ω–∞, –º—É–¥—Ä–æ—Å—Ç—å, —É–º–µ–Ω–∏–µ –≤–∏–¥–µ—Ç—å —Å—É—Ç—å –∏ –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏":
            add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
            add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 1)
        elif opt == "–Ø—Ä–∫–æ—Å—Ç—å, —Ö–∞—Ä–∏–∑–º–∞, —É–º–µ–Ω–∏–µ –∑–∞–∂–∏–≥–∞—Ç—å –∏ –≤–µ—Å—Ç–∏ –∑–∞ —Å–æ–±–æ–π —Ç–æ–ª–ø—É":
            add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        elif opt == "–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å—Ç—Ä–æ–∏—Ç—å –±–∏–∑–Ω–µ—Å, —Å–æ–∑–¥–∞–≤–∞—Ç—å –¥–µ–Ω—å–≥–∏ –∏ —Ü–µ–Ω–Ω–æ—Å—Ç—å":
            add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
        elif opt == "–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ª–µ—á–∏—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—â—É—â–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
            add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 1)
        elif opt == "–≠—Å—Ç–µ—Ç–∏–∫–∞, –≤–∫—É—Å, —á—É–≤—Å—Ç–≤–æ —Å—Ç–∏–ª—è –∏ –∫—Ä–∞—Å–æ—Ç—ã":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
        elif opt == "–°–∏–ª–∞ —Ç–µ–ª–∞, –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å, —Å–º–µ–ª–æ—Å—Ç—å –≤ –¥–µ–π—Å—Ç–≤–∏–∏":
            add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
        elif opt == "–£–º–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –±–æ–ª—å—à–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –∫–æ–º–∞–Ω–¥—ã":
            add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
        elif opt == "–õ—ë–≥–∫–æ—Å—Ç—å –≤ –æ–±—â–µ–Ω–∏–∏, —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞, —É–º–µ–Ω–∏–µ —Ä–∞–∑—Ä—è–∂–∞—Ç—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ":
            add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 2)

    st.subheader("2. –õ—é–¥–∏, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Ç–µ–±–µ —Ç—è–∂–µ–ª–æ")

    q2 = st.multiselect(
        "–° –∫–∞–∫–∏–º–∏ —Ç–∏–ø–∞–º–∏ –ª—é–¥–µ–π —Ç–µ–±–µ **—Å–ª–æ–∂–Ω–µ–µ –≤—Å–µ–≥–æ** (—ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏ —Ç—è–∂–µ–ª–æ, –Ω–µ –ø–æ–Ω–∏–º–∞–µ—à—å –∏—Ö)?",
        options=[
            "–°–≤–µ—Ä—Ö—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∞—Ä–∏ –±–µ–∑ —ç–º–æ—Ü–∏–π",
            "–û—á–µ–Ω—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ –ª—é–¥–∏",
            "–ñ—ë—Å—Ç–∫–∏–µ –ø—Ä–æ–¥–∞–≤—Ü—ã, —Ç–æ–ª—å–∫–æ –ø—Ä–æ –¥–µ–Ω—å–≥–∏",
            "–õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ ¬´–≤–µ—á–Ω–æ –≤ –∂–µ—Ä—Ç–≤–µ¬ª",
            "–°—É–ø–µ—Ä–æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª-—Ñ—Ä–∏–∫–∏",
            "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ª–∏–¥–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–æ –≤—Å—ë –≤–Ω–∏–º–∞–Ω–∏–µ",
            "–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Ç–Ω—ã–µ –æ–¥–∏–Ω–æ—á–∫–∏, –Ω–µ –∏–¥—É—â–∏–µ –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç",
        ],
        key="b3_q2",
    )

    # –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –ø–æ–¥—Å–∫–∞–∑–∫—É –ø–æ 3-–µ–º—É —Ä—è–¥—É, –ø–æ–∫–∞ –≤ –±–∞–ª–ª—ã –Ω–µ –ª–µ–∑–µ–º.
    # –ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–≤–µ—Ä—Å–Ω—É—é –ª–æ–≥–∏–∫—É.

    st.subheader("3. –ì–µ—Ä–æ–∏ –∏ –≤—Å–µ–ª–µ–Ω–Ω—ã–µ")

    q3 = st.multiselect(
        "–ö–∞–∫–∏–µ –≥–µ—Ä–æ–∏/—Ç–∏–ø—ã –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ–±—è —Ü–µ–ø–ª—è—é—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ?",
        options=[
            "–ú—É–¥—Ä—ã–µ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∏, –º–∞–≥–∏, —É—á–∏—Ç–µ–ª—è",
            "–•–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–µ –ª–∏–¥–µ—Ä—ã, –∞—Ä—Ç–∏—Å—Ç—ã, —Ä–æ–∫-–∑–≤—ë–∑–¥—ã",
            "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏, –∞–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç—ã, —Å–æ–∑–¥–∞—Ç–µ–ª–∏ –∏–º–ø–µ—Ä–∏–π",
            "–¶–µ–ª–∏—Ç–µ–ª–∏, —ç–º–ø–∞—Ç—ã, –∑–∞—â–∏—Ç–Ω–∏–∫–∏ —Å–ª–∞–±—ã—Ö",
            "–•—É–¥–æ–∂–Ω–∏–∫–∏, –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä—ã, —Å–æ–∑–¥–∞—Ç–µ–ª–∏ –∫—Ä–∞—Å–∏–≤—ã—Ö –º–∏—Ä–æ–≤",
            "–í–æ–∏–Ω—ã, –±–æ–π—Ü—ã, —Å–ø–∞—Å–∞—Ç–µ–ª–∏, —Å–ø–µ—Ü–Ω–∞–∑",
            "–°—Ç—Ä–∞—Ç–µ–≥–∏ –∏ –ø–æ–ª–∫–æ–≤–æ–¥—Ü—ã, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –±–æ–ª—å—à–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤",
            "–¢—Ä–∏–∫—Å—Ç–µ—Ä—ã, –∫–æ–º–∏–∫–∏, –ª—ë–≥–∫–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, —É–º–µ—é—â–∏–µ –≤—ã–∫—Ä—É—Ç–∏—Ç—å—Å—è",
        ],
        key="b3_q3",
    )

    for opt in q3:
        if opt == "–ú—É–¥—Ä—ã–µ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∏, –º–∞–≥–∏, —É—á–∏—Ç–µ–ª—è":
            add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
        elif opt == "–•–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–µ –ª–∏–¥–µ—Ä—ã, –∞—Ä—Ç–∏—Å—Ç—ã, —Ä–æ–∫-–∑–≤—ë–∑–¥—ã":
            add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        elif opt == "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏, –∞–≤–∞–Ω—Ç—é—Ä–∏—Å—Ç—ã, —Å–æ–∑–¥–∞—Ç–µ–ª–∏ –∏–º–ø–µ—Ä–∏–π":
            add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
            add_score(local_scores, "–†—É–±–∏–Ω", "c2", 1)
        elif opt == "–¶–µ–ª–∏—Ç–µ–ª–∏, —ç–º–ø–∞—Ç—ã, –∑–∞—â–∏—Ç–Ω–∏–∫–∏ —Å–ª–∞–±—ã—Ö":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
        elif opt == "–•—É–¥–æ–∂–Ω–∏–∫–∏, –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä—ã, —Å–æ–∑–¥–∞—Ç–µ–ª–∏ –∫—Ä–∞—Å–∏–≤—ã—Ö –º–∏—Ä–æ–≤":
            add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
        elif opt == "–í–æ–∏–Ω—ã, –±–æ–π—Ü—ã, —Å–ø–∞—Å–∞—Ç–µ–ª–∏, —Å–ø–µ—Ü–Ω–∞–∑":
            add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
        elif opt == "–°—Ç—Ä–∞—Ç–µ–≥–∏ –∏ –ø–æ–ª–∫–æ–≤–æ–¥—Ü—ã, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –±–æ–ª—å—à–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤":
            add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
        elif opt == "–¢—Ä–∏–∫—Å—Ç–µ—Ä—ã, –∫–æ–º–∏–∫–∏, –ª—ë–≥–∫–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, —É–º–µ—é—â–∏–µ –≤—ã–∫—Ä—É—Ç–∏—Ç—å—Å—è":
            add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 2)

    st.subheader("4. –†–æ–ª—å –≤ –∫–∏–Ω–æ-–≤—Å–µ–ª–µ–Ω–Ω–æ–π")

    q4 = st.radio(
        "–ï—Å–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, —á—Ç–æ —Ç—ã –≤ —Å–≤–æ–µ–π –ª—é–±–∏–º–æ–π –∫–∏–Ω–æ-–≤—Å–µ–ª–µ–Ω–Ω–æ–π, –∫–µ–º —Ç—ã —Ç–∞–º **–±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ö–æ—á–µ—à—å –±—ã—Ç—å**?",
        options=[
            "–ì–µ—Ä–æ–µ–º –Ω–∞ –ø–µ—Ä–µ–¥–æ–≤–æ–π, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–π—Å—Ç–≤—É–µ—Ç –∏ —Å–ø–∞—Å–∞–µ—Ç",
            "–ú—É–¥—Ä—ã–º –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–º/–º–∞–≥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç –≥–ª—É–±–∂–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç",
            "–õ–∏–¥–µ—Ä–æ–º/–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ—Ö —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –≤–µ–¥—ë—Ç",
            "–•–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–º –∞—Ä—Ç–∏—Å—Ç–æ–º/–ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º, –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—Å–µ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç",
            "–°–æ–∑–¥–∞—Ç–µ–ª–µ–º –º–∏—Ä–∞: –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–æ–º, —Ö—É–¥–æ–∂–Ω–∏–∫–æ–º, –¥–∏–∑–∞–π–Ω–µ—Ä–æ–º",
            "–°—Ç—Ä–∞—Ç–µ–≥–æ–º –≤ —Ç–µ–Ω–∏: –≤—Å—ë –ø—Ä–æ–¥—É–º—ã–≤–∞–µ—Ç, —á—Ç–æ–±—ã —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–ª–∞",
        ],
        key="b3_q4",
    )

    if q4 == "–ì–µ—Ä–æ–µ–º –Ω–∞ –ø–µ—Ä–µ–¥–æ–≤–æ–π, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–π—Å—Ç–≤—É–µ—Ç –∏ —Å–ø–∞—Å–∞–µ—Ç":
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)
    elif q4 == "–ú—É–¥—Ä—ã–º –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–º/–º–∞–≥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≤–∏–¥–∏—Ç –≥–ª—É–±–∂–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç":
        add_score(local_scores, "–°–∞–ø—Ñ–∏—Ä", "c1", 2)
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)
    elif q4 == "–õ–∏–¥–µ—Ä–æ–º/–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ—Ö —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –≤–µ–¥—ë—Ç":
        add_score(local_scores, "–†—É–±–∏–Ω", "c2", 2)
    elif q4 == "–•–∞—Ä–∏–∑–º–∞—Ç–∏—á–Ω—ã–º –∞—Ä—Ç–∏—Å—Ç–æ–º/–ø–µ—Ä—Å–æ–Ω–∞–∂–µ–º, –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—Å–µ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç":
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
    elif q4 == "–°–æ–∑–¥–∞—Ç–µ–ª–µ–º –º–∏—Ä–∞: –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–æ–º, —Ö—É–¥–æ–∂–Ω–∏–∫–æ–º, –¥–∏–∑–∞–π–Ω–µ—Ä–æ–º":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
    elif q4 == "–°—Ç—Ä–∞—Ç–µ–≥–æ–º –≤ —Ç–µ–Ω–∏: –≤—Å—ë –ø—Ä–æ–¥—É–º—ã–≤–∞–µ—Ç, —á—Ç–æ–±—ã —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–ª–∞":
        add_score(local_scores, "–Ø–Ω—Ç–∞—Ä—å", "c1", 2)
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 1)

    st.subheader("5. –°—É–ø–µ—Ä—Å–∏–ª–∞ –∏ –º–∏—Å—Å–∏—è")

    q5 = st.radio(
        "–ö–∞–∫—É—é **—Å—É–ø–µ—Ä—Å–∏–ª—É** —Ç—ã –±—ã –≤—ã–±—Ä–∞–ª(–∞), –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É?",
        options=[
            "–í–∏–¥–µ—Ç—å –∏—Å—Ç–∏–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Å–º—ã—Å–ª—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–≥–æ",
            "–£–ø—Ä–∞–≤–ª—è—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ–º –∏ —ç–º–æ—Ü–∏—è–º–∏ –ª—é–¥–µ–π",
            "–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∏ –¥–µ–Ω—å–≥–∏",
            "–ò—Å—Ü–µ–ª—è—Ç—å –ª—é–¥–µ–π (—Ç–µ–ª–æ/–¥—É—à—É), –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–∏–ª—É",
            "–°–æ–∑–¥–∞–≤–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–µ –ø–æ –∫—Ä–∞—Å–æ—Ç–µ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞",
            "–û–±–ª–∞–¥–∞—Ç—å –Ω–µ—á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π —Å–∏–ª–æ–π –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å—é",
        ],
        key="b3_q5",
    )

    if q5 == "–í–∏–¥–µ—Ç—å –∏—Å—Ç–∏–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Å–º—ã—Å–ª—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–≥–æ":
        add_score(local_scores, "–ê–º–µ—Ç–∏—Å—Ç", "c1", 2)
    elif q5 == "–£–ø—Ä–∞–≤–ª—è—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ–º –∏ —ç–º–æ—Ü–∏—è–º–∏ –ª—é–¥–µ–π":
        add_score(local_scores, "–ì—Ä–∞–Ω–∞—Ç", "c2", 2)
        add_score(local_scores, "–ì–µ–ª–∏–æ–¥–æ—Ä", "c2", 1)
    elif q5 == "–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∏ –¥–µ–Ω—å–≥–∏":
        add_score(local_scores, "–¶–∏—Ç—Ä–∏–Ω", "c3", 2)
    elif q5 == "–ò—Å—Ü–µ–ª—è—Ç—å –ª—é–¥–µ–π (—Ç–µ–ª–æ/–¥—É—à—É), –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–∏–ª—É":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c1", 2)
    elif q5 == "–°–æ–∑–¥–∞–≤–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–µ –ø–æ –∫—Ä–∞—Å–æ—Ç–µ –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞":
        add_score(local_scores, "–ò–∑—É–º—Ä—É–¥", "c2", 2)
    elif q5 == "–û–±–ª–∞–¥–∞—Ç—å –Ω–µ—á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π —Å–∏–ª–æ–π –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å—é":
        add_score(local_scores, "–®—É–Ω–≥–∏—Ç", "c3", 2)

    st.subheader("6. –°–≤–æ–±–æ–¥–Ω—ã–π —Ä–∞—Å—Å–∫–∞–∑")

    t3 = st.text_area(
        "–û–ø–∏—à–∏ –æ–¥–Ω—É —Å—Ü–µ–Ω—É –∏–∑ –≤–æ–æ–±—Ä–∞–∂–∞–µ–º–æ–π –∏—Å—Ç–æ—Ä–∏–∏/—Ñ–∏–ª—å–º–∞, –≥–¥–µ —Ç—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω–∞ —Å–≤–æ—ë–º –º–µ—Å—Ç–µ. "
        "–ö—Ç–æ –≤–æ–∫—Ä—É–≥, —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å, —á—Ç–æ –ª—é–¥–∏ –ø–æ–ª—É—á–∞—é—Ç –æ—Ç —Ç–µ–±—è?",
        key="b3_text1",
        height=180,
    )
    if t3.strip():
        text_fragments.append("–ì–µ—Ä–æ–π –∏ –≤—Å–µ–ª–µ–Ω–Ω–∞—è:\n" + t3.strip())

    if st.button("‚úîÔ∏è –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ë–ª–æ–∫–∞ 3"):
        st.session_state.block3_cols = local_scores
        full_text = "\n\n".join(text_fragments).strip()
        st.session_state.block3_text = full_text

        st.success("–ë–ª–æ–∫ 3 —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –ú–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –ò—Ç–æ–≥–∏ üåü")
        st.write("–ß–µ—Ä–Ω–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –ë–ª–æ–∫—É 3:")
        st.json(local_scores)


# ========================================
# –ê–ì–†–ï–ì–ê–¢–û–† 3√ó3 + –°–í–û–î–ù–´–ô –¢–ï–ö–°–¢
# ========================================

def aggregate_results():
    st.header("–ò—Ç–æ–≥–æ–≤–∞—è –∫–∞—Ä—Ç–∞ 3√ó3 –ø–æ –≤—Å–µ–º –±–ª–æ–∫–∞–º")

    # –°—É–º–º–∏—Ä—É–µ–º –≤—Å–µ –±–ª–æ–∫–∏
    combined = {p: {c: 0 for c in COLUMNS} for p in POTENTIALS}

    for block in (1, 2, 3):
        cols_key = f"block{block}_cols"
        if cols_key in st.session_state and st.session_state[cols_key]:
            for p in POTENTIALS:
                for c in COLUMNS:
                    combined[p][c] += st.session_state[cols_key].get(p, {}).get(c, 0)

    data = []
    for p in POTENTIALS:
        row = {
            "–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª": p,
            "–°—Ç–æ–ª–±–µ—Ü 1 (–∏–Ω—Ç—É–∏—Ü–∏—è / –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ / —Å–º—ã—Å–ª)": combined[p]["c1"],
            "–°—Ç–æ–ª–±–µ—Ü 2 (–ø—Ä–æ—Ü–µ—Å—Å / —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ / –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ)": combined[p]["c2"],
            "–°—Ç–æ–ª–±–µ—Ü 3 (–¥–µ–π—Å—Ç–≤–∏–µ / –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç / —Ä–µ–∑—É–ª—å—Ç–∞—Ç)": combined[p]["c3"],
        }
        data.append(row)

    df = pd.DataFrame(data)
    st.subheader("–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞–º (–ø–æ —Ç—Ä—ë–º —Å—Ç–æ–ª–±—Ü–∞–º)")
    st.dataframe(df, use_container_width=True)

    st.markdown(
        "_–ß–µ–º –≤—ã—à–µ —á–∏—Å–ª–æ –≤ —Å—Ç–æ–ª–±—Ü–µ ‚Äî —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —ç—Ç–æ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –ø—Ä–æ—è–≤–ª—è–ª—Å—è –ø–æ –æ—Ç–≤–µ—Ç–∞–º "
        "–≤–æ –≤—Å–µ—Ö —Ç—Ä—ë—Ö –±–ª–æ–∫–∞—Ö. –ú–∞—Å—Ç–µ—Ä —É–∂–µ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä—è–¥–∞–º** –∏ "
        "**—Å–º–µ—â–µ–Ω–∏—è** –≤ –∂–∏–≤–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏._"
    )

    # –°–≤–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
    full_text_parts = []
    for block in (1, 2, 3):
        text_key = f"block{block}_text"
        txt = st.session_state.get(text_key, "")
        if txt:
            full_text_parts.append(f"=== –ë–ª–æ–∫ {block} ===\n{txt}")

    full_text = "\n\n".join(full_text_parts).strip()

    st.subheader("–°–≤–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–æ–≤ (–¥–ª—è –º–∞—Å—Ç–µ—Ä–∞)")

    if full_text:
        st.text_area(
            "–í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã (–º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —Å–∫–∞—á–∞—Ç—å)",
            value=full_text,
            height=400,
        )

        st.download_button(
            label="üíæ –°–∫–∞—á–∞—Ç—å –≤—Å—ë –∫–∞–∫ .txt",
            data=full_text,
            file_name="deep_identity_answers.txt",
            mime="text/plain",
        )
    else:
        st.info("–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –∏–∑ –±–ª–æ–∫–æ–≤.")


# ========================================
# MAIN
# ========================================

def main():
    st.set_page_config(
        page_title="Deep Identity ‚Äî –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤",
        layout="wide",
    )

    init_session_state()

    st.title("Deep Identity ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–≤–∏–∂–æ–∫ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤")

    page = st.sidebar.radio(
        "–ù–∞–≤–∏–≥–∞—Ü–∏—è",
        ["–ë–ª–æ–∫ 1", "–ë–ª–æ–∫ 2", "–ë–ª–æ–∫ 3", "–ò—Ç–æ–≥–∏"],
    )

    if page == "–ë–ª–æ–∫ 1":
        run_block1()
    elif page == "–ë–ª–æ–∫ 2":
        run_block2()
    elif page == "–ë–ª–æ–∫ 3":
        run_block3()
    elif page == "–ò—Ç–æ–≥–∏":
        aggregate_results()


if __name__ == "__main__":
    main()
